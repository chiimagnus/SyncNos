# 数据源切换功能测试场景清单

## 概述

本文档列出了与数据源切换功能相关的所有测试场景，基于最近 10 个 Git 提交的代码修改。

---

## 🔀 一、数据源切换功能（核心功能）

### 1.1 触控板滑动切换

| 场景 | 预期结果 | 通过 |
|------|----------|------|
| 在侧边栏 List 上**双指向左水平滑动** | 切换到下一个数据源（如 Apple Books → GoodLinks） | ☐ |
| 在侧边栏 List 上**双指向右水平滑动** | 切换到上一个数据源（如 GoodLinks → Apple Books） | ☐ |
| 在**第一个**数据源向右滑动 | 无反应（不能越界） | ☐ |
| 在**最后一个**数据源向左滑动 | 无反应（不能越界） | ☐ |
| **垂直滚动** List | 正常滚动，不触发数据源切换 | ☐ |
| **斜向滑动** | 不触发切换（需要水平位移 > 垂直位移 × 1.5） | ☐ |
| **缓慢滑动**（超过 0.3 秒） | 不触发切换 | ☐ |
| 切换时应有**触觉反馈** | 感受到轻微的触控板震动 | ☐ |

### 1.2 键盘快捷键切换（循环切换）

| 场景 | 预期结果 | 通过 |
|------|----------|------|
| 按 **⌘+→** (Command + Right Arrow) | 切换到下一个数据源 | ☐ |
| 按 **⌘+←** (Command + Left Arrow) | 切换到上一个数据源 | ☐ |
| 在**最后一个**数据源按 ⌘+→ | **循环**切换到第一个数据源 | ☐ |
| 在**第一个**数据源按 ⌘+← | **循环**切换到最后一个数据源 | ☐ |
| 连续按 ⌘+→ 多次 | 依次循环切换所有数据源 | ☐ |
| 连续按 ⌘+← 多次 | 依次反向循环切换所有数据源 | ☐ |
| 只启用**1个**数据源时按 ⌘+→ 或 ⌘+← | 菜单项禁用，无反应 | ☐ |
| 按 **⌘+1** | 切换到第一个启用的数据源 | ☐ |
| 按 **⌘+2** | 切换到第二个启用的数据源 | ☐ |
| 按 **⌘+3** | 切换到第三个启用的数据源 | ☐ |
| 菜单栏 View 菜单 | 显示 "Previous Data Source" 和 "Next Data Source" 选项 | ☐ |

### 1.3 指示器点击切换

| 场景 | 预期结果 | 通过 |
|------|----------|------|
| 点击底部指示器中的**非当前**数据源图标 | 切换到该数据源 | ☐ |
| 点击底部指示器中的**当前**数据源图标 | 无反应（已是当前） | ☐ |
| 鼠标悬停在指示器图标上 | 显示悬停高亮效果 | ☐ |

### 1.4 指示器显示

| 场景 | 预期结果 | 通过 |
|------|----------|------|
| 只启用**1个**数据源 | 底部指示器栏**不显示** | ☐ |
| 启用**2个或更多**数据源 | 底部指示器栏显示 | ☐ |
| 当前活动的数据源 | 显示图标 + 名称，高亮颜色 | ☐ |
| 非活动的数据源 | 只显示图标，灰色 | ☐ |

---

## 🔍 二、Filter 菜单功能

### 2.1 Filter Button 显示

| 场景 | 预期结果 | 通过 |
|------|----------|------|
| 侧边栏右下角 | 显示 Filter 按钮（漏斗图标） | ☐ |
| 点击 Filter 按钮 | 弹出菜单 | ☐ |

### 2.2 Apple Books Filter 菜单

| 场景 | 预期结果 | 通过 |
|------|----------|------|
| 排序选项：Title / Highlight Count / Last Sync | 切换排序方式，列表重新排序 | ☐ |
| 升序/降序切换 | 切换排序方向 | ☐ |
| "Titles only" 过滤 | 只显示有标题的书籍 | ☐ |

### 2.3 GoodLinks Filter 菜单

| 场景 | 预期结果 | 通过 |
|------|----------|------|
| 排序选项 | 切换排序方式 | ☐ |
| "Starred only" 过滤 | 只显示收藏的链接 | ☐ |

### 2.4 WeRead Filter 菜单

| 场景 | 预期结果 | 通过 |
|------|----------|------|
| 排序选项：Title / Highlight Count / Last Sync | 切换排序方式 | ☐ |

---

## ✅ 三、选择命令功能（菜单栏 Edit 菜单）

### 3.1 Select All / Deselect All

| 场景 | 预期结果 | 通过 |
|------|----------|------|
| 菜单栏 Edit → Select All (⌘A) | 选中当前数据源的所有项目 | ☐ |
| 菜单栏 Edit → Deselect All | 取消所有选择 | ☐ |
| 切换数据源后 | 选择状态被清空 | ☐ |
| 当前数据源无项目时 | Select All 菜单项禁用 | ☐ |
| 当前无选择时 | Deselect All 菜单项禁用 | ☐ |

### 3.2 选择状态隔离

| 场景 | 预期结果 | 通过 |
|------|----------|------|
| 在 Apple Books 中选择多本书 | 只影响 Apple Books 的选择 | ☐ |
| 切换到 GoodLinks | Apple Books 的选择被清空 | ☐ |
| 切换回 Apple Books | 选择状态为空（不会恢复） | ☐ |

---

## 📊 四、数据源启用/禁用

### 4.1 在设置中切换数据源

| 场景 | 预期结果 | 通过 |
|------|----------|------|
| 禁用当前活动的数据源 | 自动切换到下一个启用的数据源 | ☐ |
| 禁用所有数据源 | 显示空状态视图 | ☐ |
| 重新启用数据源 | 指示器更新，可以切换 | ☐ |

---

## 🎨 五、UI/UX 细节

### 5.1 动画效果

| 场景 | 预期结果 | 通过 |
|------|----------|------|
| 切换数据源 | 有平滑的弹性动画过渡 | ☐ |
| 指示器状态变化 | 有渐变动画 | ☐ |

### 5.2 视觉样式

| 场景 | 预期结果 | 通过 |
|------|----------|------|
| 底部栏背景 | 使用 `.ultraThinMaterial` 毛玻璃效果 | ☐ |
| 阴影效果 | 有轻微阴影 | ☐ |
| 各数据源颜色 | Apple Books 橙色，GoodLinks 蓝色，WeRead 绿色 | ☐ |

---

## 🔧 六、边界情况

| 场景 | 预期结果 | 通过 |
|------|----------|------|
| 应用启动时 | 恢复到上次的数据源状态 | ☐ |
| 快速连续滑动 | 每次滑动只触发一次切换 | ☐ |
| 在详情页时滑动 | 应该只影响侧边栏，不影响详情页 | ☐ |

---

## 📝 测试建议

1. **先测试基础功能**：确保滑动和点击切换正常工作
2. **测试 Filter Button**：确认右下角按钮可见且可用
3. **测试选择命令**：使用 ⌘A 测试全选功能
4. **测试边界情况**：禁用/启用数据源后的行为

---

## 相关代码文件

- `SyncNos/Views/Components/SwipeableDataSourceContainer.swift` - 滑动容器和触控板手势
- `SyncNos/Views/Components/DataSourceIndicatorBar.swift` - 底部指示器
- `SyncNos/ViewModels/Sidebar/DataSourceSwitchViewModel.swift` - 切换状态管理
- `SyncNos/Views/Components/MainListView.swift` - 主列表视图
- `SyncNos/Models/Models.swift` - ContentSource 枚举定义

---

## 相关 Git 提交

| Commit | 描述 |
|--------|------|
| `6377031` | 初始实现：创建滑动切换数据源的基础架构 |
| `6e3d245` | 添加 Filter 菜单到滑动容器 |
| `7aea263` | 重构选择命令，统一到 SwipeableDataSourceContainer |
| `ef2c0d4` | 使用 NSEvent 实现触控板滑动手势 |

